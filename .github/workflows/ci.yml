name: GitHub CI

on:
  workflow_dispatch:
    # Inputs the workflow accepts.
    inputs:
      branch:
        # branch to test
        description: 'branch to test'
        # Default value if no value is explicitly provided
        default: 'main'
        required: false

env:
  TOTO: "plop"

jobs:
  ci:
    runs-on: ${{ matrix.os }}

    # Launch a matrix of jobs
    strategy:
        matrix:
          os: [ubuntu-20.04,macos-10.15,windows-2022]
          pattern: [on,off]
          scotch: [on,off]


    steps:
      # checkout the provided branch name if workflow is manually run
      - uses: actions/checkout@v2
        if: github.event_name == 'workflow_dispatch'
        with:
          ref: ${{github.event.inputs.branch}}

      # checkout the event branch for automatic workflows
      - uses: actions/checkout@v2
        if: github.event_name != 'workflow_dispatch'

      - name: RunnerWin PatternOff
        if: ${{ matrix.pattern == 'off' }} &&  ${{ matrix.os == 'windows-2022' }}
        run: |
          echo " RunnerWin PatternOff: $TOTO"

      - name: RunnerWin
        if: ${{ matrix.os == 'windows-2022' }}
        run: |
          echo " RunnerWin: $TOTO"
